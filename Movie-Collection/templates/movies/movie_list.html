{% extends 'base/base.html' %}
{% block title %}All Movies{% endblock %}

{% block content %}
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h2>All Movies</h2>
    <a class="button" href="{% url 'movies:movie-create' %}">Create Movie</a>
  </div>

  {% if movies %}
    <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:1rem; margin-top:1rem;">
      {% for movie in movies %}
        <article class="card">
          {% if movie.poster %}
            <img src="{{ movie.poster.url }}" alt="{{ movie.title }} poster" style="max-height:300px; object-fit:cover; width:100%;"/>
          {% endif %}
          <div style="padding: 0.5rem;">
            <h3><a href="{% url 'movies:movie-detail' movie.pk %}">{{ movie.title }}</a></h3>
            <p>{{ movie.director }} &middot; {{ movie.release_date }}</p>
            <p><em>{{ movie.get_genre_display }}</em></p>
          </div>
        </article>
      {% endfor %}
    </div>

    {% if is_paginated %}
      <nav aria-label="pagination">
        {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}">Previous</a>
        {% endif %}
        <span>Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}">Next</a>
        {% endif %}
      </nav>
    {% endif %}
  {% else %}
    <p>No movies yet. <a href="{% url 'movies:movie-create' %}">Add the first one</a>.</p>
  {% endif %}
{% endblock %}